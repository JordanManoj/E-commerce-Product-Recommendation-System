
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span><span class="p">,</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">adjusted_rand_score</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;ggplot&quot;</span><span class="p">)</span>

<span class="c1">#Recommendation System - Part 1</span>
<span class="n">amazon_ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/jorda/OneDrive/Desktop/Nxt24/2 E-commerce Product Recommendation System/CSV/Amazon.csv&#39;</span><span class="p">)</span>
<span class="n">amazon_ratings</span> <span class="o">=</span> <span class="n">amazon_ratings</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amazon_ratings</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amazon_ratings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">popular_products</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">amazon_ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ProductId&#39;</span><span class="p">)[</span><span class="s1">&#39;Rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="n">most_popular</span> <span class="o">=</span> <span class="n">popular_products</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Rating&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">most_popular</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Plotting the top 30 items as a bar chart</span>
<span class="n">most_popular</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="c1"># Display the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Product ASIN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top 30 Most Popular Products&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Recommendation System - Part 2</span>
<span class="c1"># Creating a subset of the first 10,000 rows</span>
<span class="n">amazon_ratings1</span> <span class="o">=</span> <span class="n">amazon_ratings</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># Print the shape to confirm the subset size</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amazon_ratings1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Optionally, display the first few rows to confirm</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amazon_ratings1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Creating the ratings utility matrix</span>
<span class="n">ratings_utility_matrix</span> <span class="o">=</span> <span class="n">amazon_ratings1</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;Rating&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;UserId&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;ProductId&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the utility matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ratings_utility_matrix</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ratings_utility_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Transpose the ratings utility matrix</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ratings_utility_matrix</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># Display the first few rows of the transposed matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">SVD</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">decomposed_matrix</span> <span class="o">=</span> <span class="n">SVD</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">decomposed_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">decomposed_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">99</span><span class="p">])</span>

<span class="n">i</span> <span class="o">=</span> <span class="s2">&quot;6117036094&quot;</span>
<span class="n">product_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">product_ID</span> <span class="o">=</span> <span class="n">product_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_ID</span><span class="p">)</span>

<span class="n">correlation_product_ID</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="p">[</span><span class="n">product_ID</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correlation_product_ID</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">recommend</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">correlation_product_ID</span> <span class="o">&gt;</span> <span class="mf">0.90</span><span class="p">])</span>
<span class="c1"># It removes the item already bought by the customer</span>
<span class="n">recommend</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">recommend</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span>

<span class="c1">#Recomendation system 3</span>
<span class="n">product_descriptions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/jorda/OneDrive/Desktop/Nxt24/2 E-commerce Product Recommendation System/CSV/product_descriptions.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_descriptions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Missing values</span>
<span class="n">product_descriptions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/jorda/OneDrive/Desktop/Nxt24/2 E-commerce Product Recommendation System/CSV/product_descriptions.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_descriptions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_descriptions</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">product_descriptions1</span> <span class="o">=</span> <span class="n">product_descriptions</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="c1"># product_descriptions1.iloc[:,1]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_descriptions1</span><span class="p">[</span><span class="s2">&quot;product_description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">#Converting the text in product description into numerical data for analysis</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">product_descriptions1</span><span class="p">[</span><span class="s2">&quot;product_description&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>

<span class="c1"># Fitting K-Means to the dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X1</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;k-means++&#39;</span><span class="p">)</span>
<span class="n">y_kmeans</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_kmeans</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">order_centroids</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">print_cluster</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster </span><span class="si">%d</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">order_centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">terms</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># # Optimal clusters is</span>
<span class="n">true_k</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">true_k</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;k-means++&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top terms per cluster:&quot;</span><span class="p">)</span>
<span class="n">order_centroids</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">print_cluster</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster </span><span class="si">%d</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">order_centroids</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">terms</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">true_k</span><span class="p">):</span>
    <span class="n">print_cluster</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1">#Predicting clusters based on key search words</span>
<span class="k">def</span> <span class="nf">show_recommendations</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">product</span><span class="p">])</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">print_cluster</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">show_recommendations</span><span class="p">(</span><span class="s2">&quot;Your sample product description goes here.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test 1&quot;</span><span class="p">)</span>
<span class="n">show_recommendations</span><span class="p">(</span><span class="s2">&quot;cutting tool&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test 2&quot;</span><span class="p">)</span>
<span class="n">show_recommendations</span><span class="p">(</span><span class="s2">&quot;spray paint&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test 3&quot;</span><span class="p">)</span>
<span class="n">show_recommendations</span><span class="p">(</span><span class="s2">&quot;steel drill&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test 4&quot;</span><span class="p">)</span>
<span class="n">show_recommendations</span><span class="p">(</span><span class="s2">&quot;water&quot;</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre>
           UserId   ProductId  Rating   Timestamp
0  A39HTATAQ9V7YF  0205616461     5.0  1369699200
1  A3JM6GV9MNOF9X  0558925278     3.0  1355443200
2  A1Z513UWSAAO0F  0558925278     5.0  1404691200
3  A1WMRR494NWEWV  0733001998     4.0  1382572800
4  A3IAAVS479H7M7  0737104473     1.0  1274227200
(2023070, 4)
            Rating
ProductId
B001MA0QY2    7533
B0009V1YR8    2869
B0043OYFKU    2477
B0000YUXI0    2143
B003V265QW    2088
B000ZMBSPE    2041
B003BQ6QXK    1918
B004OHQR1Q    1885
B00121UVU0    1838
B000FS05VG    1589
(10000, 4)
           UserId   ProductId  Rating   Timestamp
0  A39HTATAQ9V7YF  0205616461     5.0  1369699200
1  A3JM6GV9MNOF9X  0558925278     3.0  1355443200
2  A1Z513UWSAAO0F  0558925278     5.0  1404691200
3  A1WMRR494NWEWV  0733001998     4.0  1382572800
4  A3IAAVS479H7M7  0737104473     1.0  1274227200
ProductId              0205616461  0558925278  0733001998  0737104473
\
UserId
A00205921JHJK5X9LNP42         0.0         0.0         0.0         0.0
A024581134CV80ZBLIZTZ         0.0         0.0         0.0         0.0
A03056581JJIOL5FSKJY7         0.0         0.0         0.0         0.0
A03099101ZRK4K607JVHH         0.0         0.0         0.0         0.0
A0505229A7NSH3FRXRR4          0.0         0.0         0.0         0.0

ProductId              0762451459  1304139212  1304139220  130414089X
\
UserId
A00205921JHJK5X9LNP42         0.0         0.0         0.0         0.0
A024581134CV80ZBLIZTZ         0.0         0.0         0.0         0.0
A03056581JJIOL5FSKJY7         0.0         0.0         0.0         0.0
A03099101ZRK4K607JVHH         0.0         0.0         0.0         0.0
A0505229A7NSH3FRXRR4          0.0         0.0         0.0         0.0

ProductId              130414643X  1304146537  ...  B000052YPE
B000052YPF  \
UserId                                         ...
A00205921JHJK5X9LNP42         0.0         0.0  ...         0.0
0.0
A024581134CV80ZBLIZTZ         0.0         0.0  ...         0.0
0.0
A03056581JJIOL5FSKJY7         0.0         0.0  ...         0.0
0.0
A03099101ZRK4K607JVHH         0.0         0.0  ...         0.0
0.0
A0505229A7NSH3FRXRR4          0.0         0.0  ...         0.0
0.0

ProductId              B000052YPG  B000052YPH  B000052YPM  B000052YPU
\
UserId
A00205921JHJK5X9LNP42         0.0         0.0         0.0         0.0
A024581134CV80ZBLIZTZ         0.0         0.0         0.0         0.0
A03056581JJIOL5FSKJY7         0.0         0.0         0.0         0.0
A03099101ZRK4K607JVHH         0.0         0.0         0.0         0.0
A0505229A7NSH3FRXRR4          0.0         0.0         0.0         0.0

ProductId              B000052YPV  B000052YPY  B000052YQ0  B000052YQ2
UserId
A00205921JHJK5X9LNP42         0.0         0.0         0.0         0.0
A024581134CV80ZBLIZTZ         0.0         0.0         0.0         0.0
A03056581JJIOL5FSKJY7         0.0         0.0         0.0         0.0
A03099101ZRK4K607JVHH         0.0         0.0         0.0         0.0
A0505229A7NSH3FRXRR4          0.0         0.0         0.0         0.0

[5 rows x 886 columns]
(9697, 886)
UserId      A00205921JHJK5X9LNP42  A024581134CV80ZBLIZTZ  \
ProductId
0205616461                    0.0                    0.0
0558925278                    0.0                    0.0
0733001998                    0.0                    0.0
0737104473                    0.0                    0.0
0762451459                    0.0                    0.0

UserId      A03056581JJIOL5FSKJY7  A03099101ZRK4K607JVHH  \
ProductId
0205616461                    0.0                    0.0
0558925278                    0.0                    0.0
0733001998                    0.0                    0.0
0737104473                    0.0                    0.0
0762451459                    0.0                    0.0

UserId      A0505229A7NSH3FRXRR4  A05492663T95KW63BR75K  \
ProductId
0205616461                   0.0                    0.0
0558925278                   0.0                    0.0
0733001998                   0.0                    0.0
0737104473                   0.0                    0.0
0762451459                   0.0                    0.0

UserId      A059547920Q3LZVFHLPI3  A07410232KYRFR25CIUGJ  \
ProductId
0205616461                    0.0                    0.0
0558925278                    0.0                    0.0
0733001998                    0.0                    0.0
0737104473                    0.0                    0.0
0762451459                    0.0                    0.0

UserId      A082796624UNM47DSAI6K  A0864963DOAY7LXGS5I6  ...
AZW1HXXYAC15B  \
ProductId                                                ...
0205616461                    0.0                   0.0  ...
0.0
0558925278                    0.0                   0.0  ...
0.0
0733001998                    0.0                   0.0  ...
0.0
0737104473                    0.0                   0.0  ...
0.0
0762451459                    0.0                   0.0  ...
0.0

UserId      AZWRTJPN7NXT  AZWTXHXZXFAYP  AZYQEFB9Y5N22  AZZHB6U54UDYW
\
ProductId
0205616461           0.0            0.0            0.0            0.0
0558925278           0.0            0.0            0.0            0.0
0733001998           0.0            0.0            0.0            0.0
0737104473           0.0            0.0            0.0            0.0
0762451459           0.0            0.0            0.0            0.0

UserId      AZZHJZP4GQPPZ  AZZNK89PXD006  AZZOFVMQC0BJG  AZZQXL8VDCFTV
\
ProductId
0205616461            0.0            0.0            0.0            0.0
0558925278            0.0            0.0            0.0            0.0
0733001998            0.0            0.0            0.0            0.0
0737104473            0.0            0.0            0.0            0.0
0762451459            0.0            0.0            0.0            0.0

UserId      AZZTJQ7CQZUD8
ProductId
0205616461            0.0
0558925278            0.0
0733001998            0.0
0737104473            0.0
0762451459            0.0

[5 rows x 9697 columns]
(886, 9697)
(886, 10)
(886, 886)
6117036094
99
(886,)
[&#39;1304351475&#39;, &#39;3227001055&#39;, &#39;4057362967&#39;,
&#39;4057363823&#39;, &#39;4057553908&#39;, &#39;5357955867&#39;,
&#39;5357955972&#39;, &#39;602260074X&#39;, &#39;6040652705&#39;]
(124428, 2)
(124428, 2)
   product_uid                                product_description
0       100001  Not only do angles make joints stronger, they ...
1       100002  BEHR Premium Textured DECKOVER is an innovativ...
2       100003  Classic architecture meets contemporary design...
3       100004  The Grape Solar 265-Watt Polycrystalline PV So...
4       100005  Update your bathroom with the Delta Vero Singl...
0    Not only do angles make joints stronger, they ...
1    BEHR Premium Textured DECKOVER is an innovativ...
2    Classic architecture meets contemporary design...
3    The Grape Solar 265-Watt Polycrystalline PV So...
4    Update your bathroom with the Delta Vero Singl...
5    Achieving delicious results is almost effortle...
6    The Quantum Adjustable 2-Light LED Black Emerg...
7    The Teks #10 x 1-1/2 in. Zinc-Plated Steel Was...
8    Get the House of Fara 3/4 in. x 3 in. x 8 ft. ...
9    Valley View Industries Metal Stakes (4-Pack) a...
Name: product_description, dtype: object
  (0, 6935)     0.08661742165045609
  (0, 6944)     0.1413414995253953
  (0, 2658)     0.0893871425360657
  (0, 5295)     0.10078581737558241
  (0, 1758)     0.09768530151889723
  (0, 24)       0.1413414995253953
  (0, 6594)     0.1413414995253953
  (0, 7562)     0.1413414995253953
  (0, 3532)     0.0903950754207341
  (0, 36)       0.07340584458653215
  (0, 7688)     0.1413414995253953
  (0, 1890)     0.1413414995253953
  (0, 2926)     0.0841619687203954
  (0, 545)      0.1413414995253953
  (0, 3136)     0.1044053197156438
  (0, 6929)     0.09256354866207298
  (0, 5293)     0.13255642904615592
  (0, 582)      0.12148854917771475
  (0, 6169)     0.1413414995253953
  (0, 6527)     0.09918014589997352
  (0, 3958)     0.04960259692771464
  (0, 1867)     0.10875318138733837
  (0, 323)      0.10647037199813664
  (0, 1871)     0.1113051451662391
  (0, 8534)     0.08661742165045609
  :     :
  (499, 2939)   0.1425526611849463
  (499, 974)    0.0961279293348903
  (499, 4749)   0.0769986255031151
  (499, 8623)   0.11969879364734047
  (499, 2639)   0.1306501398189535
  (499, 306)    0.10665943429895432
  (499, 6329)   0.09954387188497844
  (499, 180)    0.10080366823510069
  (499, 1730)   0.079453584162988
  (499, 2584)   0.09509217852455554
  (499, 1899)   0.06634037195843714
  (499, 6800)   0.12640194606308344
  (499, 1197)   0.10505186199097076
  (499, 6389)   0.09135610552898081
  (499, 461)    0.07794980069749487
  (499, 8908)   0.06786382664216335
  (499, 6080)   0.1425526611849463
  (499, 3050)   0.09223547617774291
  (499, 2576)   0.1549387196574106
  (499, 2765)   0.06253884791810381
  (499, 8048)   0.07844035685040818
  (499, 5668)   0.08739736340361476
  (499, 4699)   0.0859847759708318
  (499, 8836)   0.07161359376485167
  (499, 3958)   0.05334318557470992
Top terms per cluster:
Cluster 0:
 easy
 water
 tool
 tape
 handle
 duty
 heavy
 wheels
 tank
 dog

Cluster 1:
 door
 wood
 california
 water
 easy
 residents
 proposition
 nbsp
 65
 provides

Cluster 2:
 concrete
 stake
 head
 sprinkler
 brush
 grip
 used
 cutting
 cement
 ants

Cluster 3:
 light
 watt
 power
 air
 led
 fan
 cooling
 volt
 bulb
 depot

Cluster 4:
 metal
 steel
 drill
 gauge
 use
 screw
 20
 lithium
 m12
 work

Cluster 5:
 post
 posts
 deck
 fence
 plate
 flush
 speaker
 wall
 water
 roof

Cluster 6:
 cycle
 oven
 cooking
 steam
 cu
 wash
 ft
 water
 drum
 control

Cluster 7:
 ft
 patio
 natural
 outdoor
 resistant
 10
 easy
 bamboo
 use
 cutting

Cluster 8:
 storage
 shelves
 wall
 room
 adjustable
 cabinet
 design
 32
 easy
 shelf

Cluster 9:
 paint
 trim
 azek
 roller
 finish
 single
 smooth
 eliminates
 project
 tray

Cluster 7:
 ft
 patio
 natural
 outdoor
 resistant
 10
 easy
 bamboo
 use
 cutting

Test 1
Cluster 0:
 easy
 water
 tool
 tape
 handle
 duty
 heavy
 wheels
 tank
 dog

Test 2
Cluster 9:
 paint
 trim
 azek
 roller
 finish
 single
 smooth
 eliminates
 project
 tray

Test 3
Cluster 4:
 metal
 steel
 drill
 gauge
 use
 screw
 20
 lithium
 m12
 work

Test 4
Cluster 0:
 easy
 water
 tool
 tape
 handle
 duty
 heavy
 wheels
 tank
 dog
</pre></div>
<img src="figures/EPR_figure1_1.png" width="600"/>
<img src="figures/EPR_figure1_2.png" width="600"/>
